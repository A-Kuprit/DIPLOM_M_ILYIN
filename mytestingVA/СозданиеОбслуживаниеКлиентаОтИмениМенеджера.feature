#language: ru

@tree

Функционал: Проверка корректности создания новых документов Обслуживание клиента пользователем с правами Менеджер

Как тестировщик разрабатываю автотест по проверке корректности создания новых документов Обслуживание клиента 
чтобы автоматически отлавливать критические ошибки в данном бизнесс-процессе  

Контекст:
	И я подключаю профиль TestClient "DIPLOM_ILYIN_MA_FINAL"	
    И я закрываю все окна клиентского приложения

Сценарий: Я проверяю корректность создания нового документа Обслуживание клиента
* Открываю форму списка документов "Обслуживания клиентов"
	И В командном интерфейсе я выбираю 'Работа с заявками клиентов' 'Обслуживание клиента'
	Тогда открылось окно 'Обслуживание клиента'
* Создаю 1-й новый документ "Обслуживание клиента"
	И я нажимаю на кнопку с именем 'ФормаСоздать'
	Тогда открылось окно 'Обслуживание клиента (создание)'
* Выбираю в поле "Клиент" контрагента
	И я нажимаю кнопку выбора у поля с именем "Клиент"
	Тогда открылось окно 'Контрагенты'
	Если таблица  "Список" не содержит строки Тогда
		| 'Наименование'        |
		| 'ООО \"АКАЦИЯ\"'      |
		И я нажимаю на кнопку с именем 'ФормаСоздать'
		Тогда открылось окно 'Контрагент (создание)'
		И в поле с именем 'Наименование' я ввожу текст 'ООО \"АКАЦИЯ\"'
		И в поле с именем 'ИНН' я ввожу текст '5027206801'
		И в поле с именем 'КПП' я ввожу текст '502701001'
		И я нажимаю на кнопку с именем 'ФормаЗаписатьИЗакрыть'
		И я жду закрытия окна 'Контрагент (создание) *' в течение 20 секунд
		Тогда открылось окно 'Контрагенты'
	И в таблице "Список" я перехожу к строке
		| 'Наименование'        |
		| 'ООО \"АКАЦИЯ\"'      |			
	И в таблице "Список" я выбираю текущую строку
	Тогда открылось окно 'Обслуживание клиента (создание) *'
* Выбираю в поле "Специалист" специалиста
	И из выпадающего списка с именем "Специалист" я выбираю точное значение 'Егоров Сергей'
* Выбираю в поле "Договор" договор
	И я нажимаю кнопку выбора у поля с именем "Договор"
	Тогда открылось окно 'Договоры контрагентов'
	Если таблица  "Список" не содержит строки Тогда
		| 'Наименование'                 |
		| 'Сервисного обслуживания'      |
		И я нажимаю на кнопку с именем 'ФормаСоздать'
		Тогда открылось окно 'Договор контрагента (создание)'
		И в поле с именем 'Наименование' я ввожу текст 'Сервисного обслуживания'
		И из выпадающего списка с именем "Владелец" я выбираю точное значение 'ООО "АКАЦИЯ"'
		И из выпадающего списка с именем "Организация" я выбираю точное значение 'Компания «Ваш компьютерный мастер»'
		И из выпадающего списка с именем "ВидДоговора" я выбираю точное значение 'Абоненское обслуживание'
		И я нажимаю кнопку выбора у поля с именем "ПериодДействияС"
		И в поле с именем 'ПериодДействияС' я ввожу текст '01.01.2025'
		И я нажимаю кнопку выбора у поля с именем "ПериодДействияПо"
		И в поле с именем 'ПериодДействияПо' я ввожу текст '31.12.2025'
		И в поле с именем 'СуммаАбонентскойПлаты' я ввожу текст '15 000,00'
		И в поле с именем 'СтоимостьЧасаРаботы' я ввожу текст '2 000,00'
		И я нажимаю на кнопку с именем 'ФормаЗаписатьИЗакрыть'
		И я жду закрытия окна 'Договор контрагента (создание) *' в течение 20 секунд
		Тогда открылось окно 'Договоры контрагентов'
	И в таблице "Список" я перехожу к строке
		| 'Наименование'                 |
		| 'Сервисного обслуживания'      |
	И в таблице "Список" я выбираю текущую строку
	Тогда открылось окно 'Обслуживание клиента (создание) *'
* Заполняю поле "ДатаПроведенияРабот"
	И я нажимаю кнопку выбора у поля с именем "ДатаПроведенияРабот"	
	И в поле с именем 'ДатаПроведенияРабот' я ввожу текст '07.10.2025'
* Заполняю поле "ВремяНачалаРаботПлан"	
	И в поле с именем 'ВремяНачалаРабот' я ввожу текст ' 9:00:00'
* Заполняю поле "ВремяОкончанияРаботПлан"
	И в поле с именем 'ВремяОкончанияРабот' я ввожу текст '13:00:00'
* Заполняю поле "ОписаниеПроблемы"	
	И в поле с именем 'ОписаниеПроблемы' я ввожу текст 'Необходимо подключить новое рабочее место.'
	И я нажимаю на кнопку с именем 'ФормаЗаписать'
	Тогда открылось окно 'Обслуживание клиента * от *'
	И Я закрываю окно 'Обслуживание клиента * от *'
* Создаю 2-й новый документ "Обслуживание клиента"
	Тогда открылось окно 'Обслуживание клиента'
	И я нажимаю на кнопку с именем 'ФормаСоздать'
	Тогда открылось окно 'Обслуживание клиента (создание)'
* Выбираю в поле "Клиент" контрагента	
	И я нажимаю кнопку выбора у поля с именем "Клиент"
	Тогда открылось окно 'Контрагенты'
	Если таблица  "Список" не содержит строки Тогда
		| 'Наименование'              |
		| 'ООО \"АДВАНТА-М\"'         |
		И я нажимаю на кнопку с именем 'ФормаСоздать'
		Тогда открылось окно 'Контрагент (создание)'
		И в поле с именем 'Наименование' я ввожу текст 'ООО \"АДВАНТА-М\"'
		И в поле с именем 'ИНН' я ввожу текст '7708742524'
		И в поле с именем 'КПП' я ввожу текст '771501001'
		И я нажимаю на кнопку с именем 'ФормаЗаписатьИЗакрыть'
		И я жду закрытия окна 'Контрагент (создание) *' в течение 20 секунд
		Тогда открылось окно 'Контрагенты'
	И в таблице "Список" я перехожу к строке
		| 'Наименование'              |
		| 'ООО \"АДВАНТА-М\"'         |
	И в таблице "Список" я выбираю текущую строку
	Тогда открылось окно 'Обслуживание клиента (создание) *'
* Выбираю в поле "Специалист" специалиста
	И из выпадающего списка с именем "Специалист" я выбираю точное значение 'Егоров Сергей'
* Выбираю в поле "Договор" договор	
	И я нажимаю кнопку выбора у поля с именем "Договор"
	Тогда открылось окно 'Договоры контрагентов'
	Если таблица  "Список" не содержит строки Тогда
		| 'Наименование'                 |
		| 'Сервисного обслуживания'      |
		И я нажимаю на кнопку с именем 'ФормаСоздать'
		Тогда открылось окно 'Договор контрагента (создание)'
		И в поле с именем 'Наименование' я ввожу текст 'Сервисного обслуживания'
		И из выпадающего списка с именем "Владелец" я выбираю точное значение 'ООО "АДВАНТА-М"'
		И из выпадающего списка с именем "Организация" я выбираю точное значение 'Компания «Ваш компьютерный мастер»'
		И из выпадающего списка с именем "ВидДоговора" я выбираю точное значение 'Абоненское обслуживание'
		И я нажимаю кнопку выбора у поля с именем "ПериодДействияС"
		И в поле с именем 'ПериодДействияС' я ввожу текст '01.01.2025'
		И я нажимаю кнопку выбора у поля с именем "ПериодДействияПо"
		И в поле с именем 'ПериодДействияПо' я ввожу текст '31.12.2025'
		И в поле с именем 'СуммаАбонентскойПлаты' я ввожу текст '5 000,00'
		И в поле с именем 'СтоимостьЧасаРаботы' я ввожу текст '3 000,00'
		И я нажимаю на кнопку с именем 'ФормаЗаписатьИЗакрыть'
		И я жду закрытия окна 'Договор контрагента (создание) *' в течение 20 секунд
		Тогда открылось окно 'Договоры контрагентов'
	И в таблице "Список" я перехожу к строке
		| 'Наименование'                 |
		| 'Сервисного обслуживания'      |
	И в таблице "Список" я выбираю текущую строку
	Тогда открылось окно 'Обслуживание клиента (создание) *'
* Заполняю поле "ДатаПроведенияРабот"	
	И я нажимаю кнопку выбора у поля с именем "ДатаПроведенияРабот"
	И в поле с именем 'ДатаПроведенияРабот' я ввожу текст '08.04.2025'
* Заполняю поле "ВремяНачалаРаботПлан"		
	И в поле с именем 'ВремяНачалаРабот' я ввожу текст ' 9:00:00'
* Заполняю поле "ВремяОкончанияРаботПлан"	
	И в поле с именем 'ВремяОкончанияРабот' я ввожу текст '13:00:00'
* Заполняю поле "ОписаниеПроблемы"		
	И в поле с именем 'ОписаниеПроблемы' я ввожу текст 'Перегрев оборудования'
	И я нажимаю на кнопку с именем 'ФормаЗаписать'
	Тогда открылось окно 'Обслуживание клиента * от *'
	И Я закрываю окно 'Обслуживание клиента * от *'
* Создаю 3-й новый документ "Обслуживание клиента"
	Тогда открылось окно 'Обслуживание клиента'
	И я нажимаю на кнопку с именем 'ФормаСоздать'
	Тогда открылось окно 'Обслуживание клиента (создание)'
* Выбираю в поле "Клиент" контрагента		
	И я нажимаю кнопку выбора у поля с именем "Клиент"
	Тогда открылось окно 'Контрагенты'
	Если таблица  "Список" не содержит строки Тогда
		| 'Наименование'             |
		| 'ООО \"АКВАСИЛА\"' |
		И я нажимаю на кнопку с именем 'ФормаСоздать'
		Тогда открылось окно 'Контрагент (создание)'
		И в поле с именем 'Наименование' я ввожу текст 'ООО \"АКВАСИЛА\"'
		И в поле с именем 'ИНН' я ввожу текст '7719583298'
		И в поле с именем 'КПП' я ввожу текст '771901001'
		И я нажимаю на кнопку с именем 'ФормаЗаписатьИЗакрыть'
		И я жду закрытия окна 'Контрагент (создание) *' в течение 20 секунд
		Тогда открылось окно 'Контрагенты'
	И в таблице "Список" я перехожу к строке
		| 'Наименование'             |
		| 'ООО \"АКВАСИЛА\"'         |
	И в таблице "Список" я выбираю текущую строку
	Тогда открылось окно 'Обслуживание клиента (создание) *'
* Выбираю в поле "Специалист" специалиста	
	И из выпадающего списка с именем "Специалист" я выбираю точное значение 'Егоров Сергей'
* Выбираю в поле "Договор" договор		
	И я нажимаю кнопку выбора у поля с именем "Договор"
	Тогда открылось окно 'Договоры контрагентов'
	Если таблица  "Список" не содержит строки Тогда
		| 'Наименование'                 |
		| 'Сервисного обслуживания'      |
		И я нажимаю на кнопку с именем 'ФормаСоздать'
		Тогда открылось окно 'Договор контрагента (создание)'
		И в поле с именем 'Наименование' я ввожу текст 'Сервисного обслуживания'
		И из выпадающего списка с именем "Владелец" я выбираю точное значение 'ООО "АКВАСИЛА"'
		И из выпадающего списка с именем "Организация" я выбираю точное значение 'Компания «Ваш компьютерный мастер»'
		И из выпадающего списка с именем "ВидДоговора" я выбираю точное значение 'Абоненское обслуживание'
		И я нажимаю кнопку выбора у поля с именем "ПериодДействияС"
		И в поле с именем 'ПериодДействияС' я ввожу текст '01.01.2025'
		И я нажимаю кнопку выбора у поля с именем "ПериодДействияПо"
		И в поле с именем 'ПериодДействияПо' я ввожу текст '31.12.2025'
		И в поле с именем 'СуммаАбонентскойПлаты' я ввожу текст '70 000,00'
		И в поле с именем 'СтоимостьЧасаРаботы' я ввожу текст '2 000,00'
		И я нажимаю на кнопку с именем 'ФормаЗаписатьИЗакрыть'
		И я жду закрытия окна 'Договор контрагента (создание) *' в течение 20 секунд
		Тогда открылось окно 'Договоры контрагентов'
	И в таблице "Список" я перехожу к строке
		| 'Наименование'                 |
		| 'Сервисного обслуживания'      |
	И в таблице "Список" я выбираю текущую строку
	Тогда открылось окно 'Обслуживание клиента (создание) *'
* Заполняю поле "ДатаПроведенияРабот"		
	И я нажимаю кнопку выбора у поля с именем "ДатаПроведенияРабот"
	И в поле с именем 'ДатаПроведенияРабот' я ввожу текст '09.10.2025'
* Заполняю поле "ВремяНачалаРаботПлан"		
	И в поле с именем 'ВремяНачалаРабот' я ввожу текст ' 9:00:00'
* Заполняю поле "ВремяОкончанияРаботПлан"
	И в поле с именем 'ВремяОкончанияРабот' я ввожу текст '13:00:00'
* Заполняю поле "ОписаниеПроблемы"		
	И в поле с именем 'ОписаниеПроблемы' я ввожу текст 'Обновление сервера SQL'
	И я нажимаю на кнопку с именем 'ФормаЗаписать'
	Тогда открылось окно 'Обслуживание клиента * от *'
	И Я закрываю окно 'Обслуживание клиента * от *'
* Тогда в форме списка документов "Обслуживания клиентов" появились новые записи документов	
	И таблица "Список" содержит строки по шаблону:
		| 'Дата'                | 'Клиент'                    | 'Специалист'    | 'Номер'   | 'Договор'                      | 'Дата проведения работ' |
		| '**.**.2025 **:**:**' | 'ООО \"АКАЦИЯ\"'            | 'Егоров Сергей' | '000000*' | 'Сервисного обслуживания'      | '07.10.2025'            |
		| '**.**.2025 **:**:**' | 'ООО \"АДВАНТА-М\"'         | 'Егоров Сергей' | '000000*' | 'Сервисного обслуживания'      | '08.10.2025'            |
		| '**.**.2025 **:**:**' | 'ООО \"АКВАСИЛА\"'          | 'Егоров Сергей' | '000000*' | 'Сервисного обслуживания'      | '09.10.2025'            |
				